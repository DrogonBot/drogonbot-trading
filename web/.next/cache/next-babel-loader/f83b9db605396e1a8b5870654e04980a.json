{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\n\nvar _this = this,\n    _jsxFileName = \"/usr/src/app/src/pages/posts/index.tsx\";\n\nimport React from \"react\";\nvar __jsx = React.createElement;\nimport Pagination from '@material-ui/lab/Pagination';\nimport { useRouter } from 'next/router';\nimport { useEffect } from 'react';\nimport styled from 'styled-components';\nimport { SearchResults } from '../../components/pages/posts/results/SearchResults';\nimport { SearchBar } from '../../components/pages/posts/SearchBar';\nimport { SearchLogo } from '../../components/pages/posts/SearchLogo';\nimport { SearchTabs } from '../../components/pages/posts/SearchTabs';\nimport { NextSEOPosts } from '../../components/seo/NextSEOPosts';\nimport { appEnv } from '../../constants/Env.constant';\nimport { colors } from '../../constants/UI/Colors.constant';\nimport { UI } from '../../constants/UI/UI.constant';\nimport { loadCountryProvinces } from '../../store/actions/form.actions';\n\nvar Posts = function Posts(_ref) {\n  var _posts$, _posts$2;\n\n  var provinces = _ref.provinces,\n      posts = _ref.posts,\n      paginationData = _ref.paginationData;\n  var router = useRouter();\n  var _router$query = router.query,\n      searchProvince = _router$query.searchProvince,\n      searchKeyword = _router$query.searchKeyword;\n  useEffect(function () {\n    console.log(paginationData);\n  }, [paginationData]);\n  useEffect(function () {\n    // scroll to top on pagination our router.query change\n    window.scrollTo(0, 0);\n  }, [router.query]);\n\n  var onPageChange = function onPageChange(page) {\n    router.push({\n      pathname: \"/posts\",\n      query: {\n        searchProvince: searchProvince,\n        searchKeyword: searchKeyword,\n        page: page\n      }\n    });\n  };\n\n  var jobRole = ((_posts$ = posts[0]) === null || _posts$ === void 0 ? void 0 : _posts$.jobRoles[0]) || searchKeyword || \"\"; // lets assume the job role based on the first result. If not found, use user searchKeyword\n\n  return __jsx(React.Fragment, null, posts && __jsx(NextSEOPosts, {\n    jobRole: jobRole,\n    postsQty: posts.length,\n    city: ((_posts$2 = posts[0]) === null || _posts$2 === void 0 ? void 0 : _posts$2.city) || null,\n    stateCode: searchProvince,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 55,\n      columnNumber: 9\n    }\n  }), __jsx(SearchContainer, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 62,\n      columnNumber: 7\n    }\n  }, __jsx(SearchHeader, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 63,\n      columnNumber: 9\n    }\n  }, __jsx(SearchLogo, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 64,\n      columnNumber: 11\n    }\n  }), __jsx(SearchBar, {\n    provinces: provinces,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 65,\n      columnNumber: 11\n    }\n  })), __jsx(SearchMain, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 68,\n      columnNumber: 9\n    }\n  }, __jsx(SearchTabs, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 69,\n      columnNumber: 11\n    }\n  }), __jsx(SearchResults, {\n    posts: posts,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 70,\n      columnNumber: 11\n    }\n  }), __jsx(PaginationContainer, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 72,\n      columnNumber: 11\n    }\n  }, __jsx(Pagination, {\n    size: \"large\",\n    color: \"primary\",\n    page: paginationData.page,\n    count: paginationData.totalPages,\n    onChange: function onChange(e, page) {\n      console.log(\"CHANGING TO PAGE \".concat(page));\n      onPageChange(page);\n    },\n    hideNextButton: !paginationData.hasNextPage,\n    hidePrevButton: !paginationData.hasPrevPage,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 73,\n      columnNumber: 13\n    }\n  })))));\n};\n\nexport default Posts;\n\nPosts.getInitialProps = function _callee(ctx) {\n  var provinces, _ctx$query, searchProvince, searchKeyword, _ctx$query$page, page, posts, paginationData;\n\n  return _regeneratorRuntime.async(function _callee$(_context) {\n    while (1) {\n      switch (_context.prev = _context.next) {\n        case 0:\n          _context.next = 2;\n          return _regeneratorRuntime.awrap(ctx.store.dispatch(loadCountryProvinces(appEnv.appCountry)));\n\n        case 2:\n          provinces = ctx.store.getState().formReducer.states; // populate province dropdown\n\n          _ctx$query = ctx.query, searchProvince = _ctx$query.searchProvince, searchKeyword = _ctx$query.searchKeyword, _ctx$query$page = _ctx$query.page, page = _ctx$query$page === void 0 ? 1 : _ctx$query$page;\n          _context.next = 6;\n          return _regeneratorRuntime.awrap(ctx.store.dispatch(postReadFeed(page, 40, searchProvince, searchKeyword, false)));\n\n        case 6:\n          posts = ctx.store.getState().postReducer.posts;\n          paginationData = ctx.store.getState().uiReducer.paginationData;\n          return _context.abrupt(\"return\", {\n            provinces: provinces,\n            posts: posts,\n            paginationData: paginationData\n          });\n\n        case 9:\n        case \"end\":\n          return _context.stop();\n      }\n    }\n  }, null, null, null, Promise);\n};\n\nexport var PaginationContainer = styled.div.withConfig({\n  displayName: \"posts__PaginationContainer\",\n  componentId: \"sc-90uezp-0\"\n})([\"display:flex;justify-content:center;align-items:center;\"]);\nexport var SearchMain = styled.div.withConfig({\n  displayName: \"posts__SearchMain\",\n  componentId: \"sc-90uezp-1\"\n})([\"@media screen and (min-width:\", \"px){margin-left:13rem;margin-right:7.7rem;max-width:700px;margin-top:4rem;}\"], UI.mediumLayoutBreak);\nexport var SearchHeader = styled.div.withConfig({\n  displayName: \"posts__SearchHeader\",\n  componentId: \"sc-90uezp-2\"\n})([\"display:flex;flex-wrap:wrap;flex:1;@media screen and (min-width:\", \"px){flex:8;margin-top:1rem;}\"], UI.mediumLayoutBreak);\nexport var SearchContainer = styled.div.withConfig({\n  displayName: \"posts__SearchContainer\",\n  componentId: \"sc-90uezp-3\"\n})([\"padding:1rem;@media screen and (min-width:\", \"px){padding:0;}a{color:\", \";&:visited{color:\", \";}}\"], UI.mediumLayoutBreak, colors.primary, colors.accent);","map":{"version":3,"sources":["/usr/src/app/src/pages/posts/index.tsx"],"names":["Pagination","useRouter","useEffect","styled","SearchResults","SearchBar","SearchLogo","SearchTabs","NextSEOPosts","appEnv","colors","UI","loadCountryProvinces","Posts","provinces","posts","paginationData","router","query","searchProvince","searchKeyword","console","log","window","scrollTo","onPageChange","page","push","pathname","jobRole","jobRoles","length","city","totalPages","e","hasNextPage","hasPrevPage","getInitialProps","ctx","store","dispatch","appCountry","getState","formReducer","states","postReadFeed","postReducer","uiReducer","PaginationContainer","div","SearchMain","mediumLayoutBreak","SearchHeader","SearchContainer","primary","accent"],"mappings":";;;;;;;AAAA,OAAOA,UAAP,MAAuB,6BAAvB;AACA,SAASC,SAAT,QAA0B,aAA1B;AACA,SAASC,SAAT,QAA0B,OAA1B;AACA,OAAOC,MAAP,MAAmB,mBAAnB;AAEA,SAASC,aAAT,QAA8B,oDAA9B;AACA,SAASC,SAAT,QAA0B,wCAA1B;AACA,SAASC,UAAT,QAA2B,yCAA3B;AACA,SAASC,UAAT,QAA2B,yCAA3B;AACA,SAASC,YAAT,QAA6B,mCAA7B;AACA,SAASC,MAAT,QAAuB,8BAAvB;AACA,SAASC,MAAT,QAAuB,oCAAvB;AACA,SAASC,EAAT,QAAmB,gCAAnB;AACA,SAASC,oBAAT,QAAqC,kCAArC;;AAWA,IAAMC,KAAK,GAAG,SAARA,KAAQ,OAAkD;AAAA;;AAAA,MAA/CC,SAA+C,QAA/CA,SAA+C;AAAA,MAApCC,KAAoC,QAApCA,KAAoC;AAAA,MAA7BC,cAA6B,QAA7BA,cAA6B;AAC9D,MAAMC,MAAM,GAAGhB,SAAS,EAAxB;AAD8D,sBAGpBgB,MAAM,CAACC,KAHa;AAAA,MAGtDC,cAHsD,iBAGtDA,cAHsD;AAAA,MAGtCC,aAHsC,iBAGtCA,aAHsC;AAK9DlB,EAAAA,SAAS,CAAC,YAAM;AACdmB,IAAAA,OAAO,CAACC,GAAR,CAAYN,cAAZ;AACD,GAFQ,EAEN,CAACA,cAAD,CAFM,CAAT;AAIAd,EAAAA,SAAS,CAAC,YAAM;AACd;AACAqB,IAAAA,MAAM,CAACC,QAAP,CAAgB,CAAhB,EAAmB,CAAnB;AACD,GAHQ,EAGN,CAACP,MAAM,CAACC,KAAR,CAHM,CAAT;;AAKA,MAAMO,YAAY,GAAG,SAAfA,YAAe,CAACC,IAAD,EAAkB;AACrCT,IAAAA,MAAM,CAACU,IAAP,CAAY;AACVC,MAAAA,QAAQ,EAAE,QADA;AAEVV,MAAAA,KAAK,EAAE;AACLC,QAAAA,cAAc,EAAdA,cADK;AAELC,QAAAA,aAAa,EAAbA,aAFK;AAGLM,QAAAA,IAAI,EAAJA;AAHK;AAFG,KAAZ;AAQD,GATD;;AAWA,MAAMG,OAAO,GAAG,YAAAd,KAAK,CAAC,CAAD,CAAL,oDAAUe,QAAV,CAAmB,CAAnB,MAAyBV,aAAzB,IAA0C,EAA1D,CAzB8D,CAyBA;;AAE9D,SACE,4BACGL,KAAK,IACJ,MAAC,YAAD;AACE,IAAA,OAAO,EAAEc,OADX;AAEE,IAAA,QAAQ,EAAEd,KAAK,CAACgB,MAFlB;AAGE,IAAA,IAAI,EAAE,aAAAhB,KAAK,CAAC,CAAD,CAAL,sDAAUiB,IAAV,KAAkB,IAH1B;AAIE,IAAA,SAAS,EAAEb,cAJb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAFJ,EASE,MAAC,eAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE,MAAC,YAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE,MAAC,UAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADF,EAEE,MAAC,SAAD;AAAW,IAAA,SAAS,EAAEL,SAAtB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAFF,CADF,EAME,MAAC,UAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE,MAAC,UAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADF,EAEE,MAAC,aAAD;AAAe,IAAA,KAAK,EAAEC,KAAtB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAFF,EAIE,MAAC,mBAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE,MAAC,UAAD;AACE,IAAA,IAAI,EAAC,OADP;AAEE,IAAA,KAAK,EAAC,SAFR;AAGE,IAAA,IAAI,EAAEC,cAAc,CAACU,IAHvB;AAIE,IAAA,KAAK,EAAEV,cAAc,CAACiB,UAJxB;AAKE,IAAA,QAAQ,EAAE,kBAACC,CAAD,EAAIR,IAAJ,EAAa;AACrBL,MAAAA,OAAO,CAACC,GAAR,4BAAgCI,IAAhC;AACAD,MAAAA,YAAY,CAACC,IAAD,CAAZ;AACD,KARH;AASE,IAAA,cAAc,EAAE,CAACV,cAAc,CAACmB,WATlC;AAUE,IAAA,cAAc,EAAE,CAACnB,cAAc,CAACoB,WAVlC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADF,CAJF,CANF,CATF,CADF;AAsCD,CAjED;;AAmEA,eAAevB,KAAf;;AAEAA,KAAK,CAACwB,eAAN,GAAwB,iBAAMC,GAAN;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,2CAChBA,GAAG,CAACC,KAAJ,CAAUC,QAAV,CAAmB5B,oBAAoB,CAACH,MAAM,CAACgC,UAAR,CAAvC,CADgB;;AAAA;AAEhB3B,UAAAA,SAFgB,GAEJwB,GAAG,CAACC,KAAJ,CAAUG,QAAV,GAAqBC,WAArB,CAAiCC,MAF7B,EAEqC;;AAFrC,uBAI8BN,GAAG,CAACpB,KAJlC,EAIdC,cAJc,cAIdA,cAJc,EAIEC,aAJF,cAIEA,aAJF,+BAIiBM,IAJjB,EAIiBA,IAJjB,gCAIwB,CAJxB;AAAA;AAAA,2CAKhBY,GAAG,CAACC,KAAJ,CAAUC,QAAV,CACJK,YAAY,CAACnB,IAAD,EAAO,EAAP,EAAWP,cAAX,EAA2BC,aAA3B,EAA0C,KAA1C,CADR,CALgB;;AAAA;AASdL,UAAAA,KATc,GASJuB,GAAG,CAACC,KAAJ,CAAUG,QAAV,GAAqBI,WATjB,CASd/B,KATc;AAUdC,UAAAA,cAVc,GAUKsB,GAAG,CAACC,KAAJ,CAAUG,QAAV,GAAqBK,SAV1B,CAUd/B,cAVc;AAAA,2CAYf;AACLF,YAAAA,SAAS,EAATA,SADK;AAELC,YAAAA,KAAK,EAALA,KAFK;AAGLC,YAAAA,cAAc,EAAdA;AAHK,WAZe;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,CAAxB;;AAmBA,OAAO,IAAMgC,mBAAmB,GAAG7C,MAAM,CAAC8C,GAAV;AAAA;AAAA;AAAA,+DAAzB;AAMP,OAAO,IAAMC,UAAU,GAAG/C,MAAM,CAAC8C,GAAV;AAAA;AAAA;AAAA,qHAEWtC,EAAE,CAACwC,iBAFd,CAAhB;AAUP,OAAO,IAAMC,YAAY,GAAGjD,MAAM,CAAC8C,GAAV;AAAA;AAAA;AAAA,yGAMStC,EAAE,CAACwC,iBANZ,CAAlB;AAYP,OAAO,IAAME,eAAe,GAAGlD,MAAM,CAAC8C,GAAV;AAAA;AAAA;AAAA,0GAIMtC,EAAE,CAACwC,iBAJT,EASfzC,MAAM,CAAC4C,OATQ,EAWb5C,MAAM,CAAC6C,MAXM,CAArB","sourcesContent":["import Pagination from '@material-ui/lab/Pagination';\nimport { useRouter } from 'next/router';\nimport { useEffect } from 'react';\nimport styled from 'styled-components';\n\nimport { SearchResults } from '../../components/pages/posts/results/SearchResults';\nimport { SearchBar } from '../../components/pages/posts/SearchBar';\nimport { SearchLogo } from '../../components/pages/posts/SearchLogo';\nimport { SearchTabs } from '../../components/pages/posts/SearchTabs';\nimport { NextSEOPosts } from '../../components/seo/NextSEOPosts';\nimport { appEnv } from '../../constants/Env.constant';\nimport { colors } from '../../constants/UI/Colors.constant';\nimport { UI } from '../../constants/UI/UI.constant';\nimport { loadCountryProvinces } from '../../store/actions/form.actions';\nimport { IProvince } from '../../types/Form.types';\nimport { IPost } from '../../types/Post.types';\nimport { IPaginationData } from '../../types/UI.types';\n\ninterface IProps {\n  provinces: IProvince[];\n  posts: IPost[];\n  paginationData: IPaginationData;\n}\n\nconst Posts = ({ provinces, posts, paginationData }: IProps) => {\n  const router = useRouter();\n\n  const { searchProvince, searchKeyword } = router.query;\n\n  useEffect(() => {\n    console.log(paginationData);\n  }, [paginationData]);\n\n  useEffect(() => {\n    // scroll to top on pagination our router.query change\n    window.scrollTo(0, 0);\n  }, [router.query]);\n\n  const onPageChange = (page: number) => {\n    router.push({\n      pathname: \"/posts\",\n      query: {\n        searchProvince,\n        searchKeyword,\n        page\n      }\n    });\n  };\n\n  const jobRole = posts[0]?.jobRoles[0] || searchKeyword || \"\"; // lets assume the job role based on the first result. If not found, use user searchKeyword\n\n  return (\n    <>\n      {posts && (\n        <NextSEOPosts\n          jobRole={jobRole}\n          postsQty={posts.length}\n          city={posts[0]?.city || null}\n          stateCode={searchProvince}\n        />\n      )}\n      <SearchContainer>\n        <SearchHeader>\n          <SearchLogo />\n          <SearchBar provinces={provinces} />\n        </SearchHeader>\n\n        <SearchMain>\n          <SearchTabs />\n          <SearchResults posts={posts} />\n\n          <PaginationContainer>\n            <Pagination\n              size=\"large\"\n              color=\"primary\"\n              page={paginationData.page}\n              count={paginationData.totalPages}\n              onChange={(e, page) => {\n                console.log(`CHANGING TO PAGE ${page}`);\n                onPageChange(page);\n              }}\n              hideNextButton={!paginationData.hasNextPage}\n              hidePrevButton={!paginationData.hasPrevPage}\n            />\n          </PaginationContainer>\n        </SearchMain>\n      </SearchContainer>\n    </>\n  );\n};\n\nexport default Posts;\n\nPosts.getInitialProps = async ctx => {\n  await ctx.store.dispatch(loadCountryProvinces(appEnv.appCountry));\n  const provinces = ctx.store.getState().formReducer.states; // populate province dropdown\n\n  const { searchProvince, searchKeyword, page = 1 } = ctx.query;\n  await ctx.store.dispatch(\n    postReadFeed(page, 40, searchProvince, searchKeyword, false)\n  );\n\n  const { posts } = ctx.store.getState().postReducer;\n  const { paginationData } = ctx.store.getState().uiReducer;\n\n  return {\n    provinces,\n    posts,\n    paginationData\n  };\n};\n\nexport const PaginationContainer = styled.div`\n  display: flex;\n  justify-content: center;\n  align-items: center;\n`;\n\nexport const SearchMain = styled.div`\n  /*DESKTOP ONLY CODE*/\n  @media screen and (min-width: ${UI.mediumLayoutBreak}px) {\n    margin-left: 13rem;\n    margin-right: 7.7rem;\n    max-width: 700px;\n    margin-top: 4rem;\n  }\n`;\n\nexport const SearchHeader = styled.div`\n  display: flex;\n  flex-wrap: wrap;\n  flex: 1;\n\n  /*DESKTOP ONLY CODE*/\n  @media screen and (min-width: ${UI.mediumLayoutBreak}px) {\n    flex: 8;\n    margin-top: 1rem;\n  }\n`;\n\nexport const SearchContainer = styled.div`\n  padding: 1rem;\n\n  /*DESKTOP ONLY CODE*/\n  @media screen and (min-width: ${UI.mediumLayoutBreak}px) {\n    padding: 0;\n  }\n\n  a {\n    color: ${colors.primary};\n    &:visited {\n      color: ${colors.accent};\n    }\n  }\n`;\n"]},"metadata":{},"sourceType":"module"}